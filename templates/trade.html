<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>B2B Trade | IndusTech</title>

  <link rel="stylesheet" href="{{ url_for('static', filename='css/trade.css') }}">
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    crossorigin="anonymous">
</head>
<body>

<!-- ================= NAVBAR ================= -->
<header class="navbar">
    <div class="logo">
      <i class="fa-solid fa-industry"></i>
      <div>
        <strong>IndusTech</strong><br>
        <small>Industrial Ecosystem</small>
      </div>
    </div>
  
    <nav class="nav-links">
      <a href="{{ url_for('home') }}" > <i class="fa-solid fa-house"></i> Home</a>
      <a href="{{url_for('industrymap') }}">  <i class="fa-solid fa-location-dot"></i> Industrial Map</a>
      <a href="{{url_for('jobportal') }}" > <i class="fa-solid fa-briefcase"></i> Job Portal</a>
      <a href="{{url_for('trade') }}" class="active"> <i class="fa-solid fa-box"></i> B2B Trade</a>
    </nav>
  
    <div class="auth">
      {% if session.get('user_type') == 'worker' %}
        <a href="{{ url_for('workerprofile') }}" class="profile"> <i class='fa-solid fa-user'></i> My profile</a>
      <a href="{{ url_for('logout') }}" class="signup">Logout</a>
      {% elif session.get('user_type') == 'company' %}
      <a href="{{ url_for('companyprofile') }}" class="profile"> <i class='fa-solid fa-user'></i> My profile</a>
      <a href="{{ url_for('logout') }}" class="signup">Logout</a>
      {% else %}
      <a href="{{ url_for('login') }}" class="signup">Login</a>
      {% endif %}
    </div>
  </header>


<!-- HERO / SEARCH SECTION -->
<section class="b2b-hero">
    <div class="hero-content">
      <h1>B2B Trade Portal</h1>
      <p>Buy and sell raw materials. Connect with verified suppliers near you.</p>
  
      <div class="hero-search-wrapper">
        <div class="hero-search-bar">
          
          <div class="search-input">
            <i class="fa-solid fa-magnifying-glass"></i>
            <input
              type="text"
              placeholder="Search products, materials, or suppliers..."
            />
          </div>
      
          <button class="search-btn">
            Search Products
          </button>
      
        </div>
      </div>
      
    </div>
  </section>
<!--   
  -- CATEGORY FILTERS 
  <section class="category-bar">
    <span class="label">Categories:</span>
  
    <button class="cat active">All Products</button>
    <button class="cat">Raw Materials</button>
    <button class="cat">Equipment</button>
    <button class="cat">Chemicals</button>
    <button class="cat">Construction</button>
    <button class="cat">Packaging</button>
    <button class="cat">Textiles</button>
  </section>
-->

<!-- MAIN -->
<main class="container">

  <div class="b2b-grid">

    <!-- LEFT SIDEBAR -->
    <aside class="featured-suppliers">
        <h3>Apply Filters</h3>
        <div class="filter-grid" id="filterPanel">

          
          <!-- Shift -->
          <div class="filter-box">
            <h4>Sort by Date</h4>
            <select class="filter-select" id="shiftFilter">
              <option value="">Any</option>
              <option value="NF">Newest First</option>
              <option value="OF">Oldest First</option>
            </select>
          </div>
        
          <!-- Salary -->
          <div class="filter-box">
            <h4>Minimum Quantity</h4>
            <select class="filter-select" id="salaryFilter">
              <option value="">Any</option>
              <option value="050">Less than 50</option>
              <option value="100">More than 100</option>
              <option value="50100">More than 50</option>
            </select>
          </div>
        
          <!-- Openings -->
          <div class="filter-box">
            <h4>Filter by Price</h4>
            <select class="filter-select" id="openingFilter">
              <option value="">Any</option>
              <option value="l2h">Low to High</option>
              <option value="h2l">High to Low</option>
            </select>
          </div>
        
          <!-- Clear -->
          
            <button class="apply-btn" id="applyFiltersBtn">
              Apply Filters
            </button>
            <button class="clear-btn">
              Clear Filters
            </button>
          
          
        
        </div>
      
      </aside>
      
      

    <!-- PRODUCTS -->
    <section class="products-section">

      <div class="products-header">
        <h2>{{ pagination.total }} Sell Item Found</h2>

        <div class="products-controls">

            <!-- VIEW TOGGLE -->
            <div class="view-toggle">
              <button id="gridView" class="active" aria-label="Grid view">
                <i class="fa-solid fa-table-cells"></i>
              </button>
          
              <button id="listView" aria-label="List view">
                <i class="fa-solid fa-list"></i>
              </button>
            </div>
          
          </div>
          
      </div>


      <div class="products-scroll"> 
      <div class="products-grid">
            
          {% for item in sell_items %}
          <a href="{{ url_for('tradevisit', sell_id=item.sell_id) }}" class="job-card-link">
          
            <div class="product-card">
          
              {% if item.images and item.images|length > 0 %}
          
                <!-- IMAGE CAROUSEL -->
                <div class="job-carousel"
                     data-images='{{ item.images | tojson }}'
                     data-index="0">
          
                  <img class="job-img"
                       src="{{ url_for('static', filename='uploads/sell_items/' ~ item.images[0]) }}"
                       alt="Product Image"
                       onclick="event.stopPropagation()">
                </div>
          
              {% else %}
          
                <!-- FALLBACK ICON -->
                <div class="product-image">
                  <i class="fa-solid fa-box"></i>
                </div>
          
              {% endif %}
         
            <!-- CONTENT -->
            <div class="product-body">
                <span class="product-category">{{ item.sell_category }}</span>

                <h4 class="product-title">{{ item.sell_name }}</h4>
                <p class="product-company">by {{ item.company.company_name}}</p>

                <div class="product-price-row">
                <span class="price">₹{{ item.sell_price}}</span>
                <span class="moq">MOQ: {{ item.sell_quantity }} <i class="fa-solid fa-circle-check"></i></span>
                </div>

                <div class="product-stock">
                <span class="dot"></span> In Stock
                </div>
            </div>  
        </div>
        {% else %}
          <p>No jobs found.</p>
        {% endfor %}
        </div>

        <div class="pagination">

          {% if pagination.has_prev %}
            <a href="{{ url_for('trade', page=pagination.prev_num) }}" class="page-btn">
                ← Previous
            </a>
          {% endif %}
        
          <span class="page-info">
              Page {{ pagination.page }} of {{ pagination.pages }}
          </span>
        
          {% if pagination.has_next %}
            <a href="{{ url_for('trade', page=pagination.next_num) }}" class="page-btn">
                Next →
            </a>
          {% endif %}
      </div>
      </div>
    </section>

  </div>

  <!-- CTA -->
  <section class="sell-cta">
    <h2>Want to Sell Your Products?</h2>
    <p>Register as a supplier and reach thousands of businesses</p>

    <div class="cta-buttons">
      <a href="{{ url_for('signup')}}" class="cta-btn primary">Register as a Supplier</a>
      <a href="{{ url_for('login')}}" class="cta-btn secondary">Supplier Login</a>
    </div>
  </section>

</main>

<!-- FOOTER --><footer>
        <div class="footer-content">
          <div class="footer-section">
              <h4>IndusTech</h4>
              <p>Connecting India's industrial workforce with opportunities.</p>
          </div>
          <div class="footer-section">
              <h4>Quick Links</h4>
              <a href="home.html">Home</a>
              <a href="job-portal.html">Find Jobs</a>
              <a href="industry-map.html">Industry Map</a>
              <a href="b2btrade.html">B2B Trade</a>
          </div>
          <div class="footer-section">
              <h4>Support</h4>
              <a href="#">Help Center</a>
              <a href="#">Contact Us</a>
              <a href="#">Privacy Policy</a>
              <a href="#">Terms of Service</a>
          </div>
      </div>
  </footer>
<script>
    const gridBtn = document.getElementById("gridView");
    const listBtn = document.getElementById("listView");
    const grid = document.querySelector(".products-grid");
  
    gridBtn.addEventListener("click", () => {
      grid.classList.remove("list-view");
      gridBtn.classList.add("active");
      listBtn.classList.remove("active");
    });
  
    listBtn.addEventListener("click", () => {
      grid.classList.add("list-view");
      listBtn.classList.add("active");
      gridBtn.classList.remove("active");
    });
  </script>
  <script>
    let hoverTimers = new WeakMap();
    
    document.querySelectorAll('.job-carousel').forEach(carousel => {
      const images = JSON.parse(carousel.dataset.images || '[]');
      if (images.length <= 1) return;
    
      const img = carousel.querySelector('.job-img');
    
      carousel.addEventListener('mouseenter', () => {
        let index = 0;
    
        const timer = setInterval(() => {
          index = (index + 1) % images.length;
          img.style.opacity = '0';
    
          setTimeout(() => {
            img.src = `/static/uploads/sell_items/${images[index]}`;
            img.style.opacity = '1';
          }, 200);
    
        }, 900);
    
        hoverTimers.set(carousel, timer);
      });
    
      carousel.addEventListener('mouseleave', () => {
        clearInterval(hoverTimers.get(carousel));
        hoverTimers.delete(carousel);
    
        // reset to first image
        img.src = `/static/uploads/sell_items/${images[0]}`;
        img.style.opacity = '1';
      });
    });

    document.getElementById("applyFiltersBtn").addEventListener("click", () => {
  const date = document.getElementById("shiftFilter").value;
  const qty = document.getElementById("salaryFilter").value;
  const price = document.getElementById("openingFilter").value;

  const params = new URLSearchParams({
    date,
    qty,
    price
  });

  window.location.href = `/trade?${params.toString()}`;
});

    </script>
    
</body>
</html>
