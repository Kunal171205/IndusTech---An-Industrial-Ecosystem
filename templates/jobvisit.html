<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Job Details | IndusTech</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/jobvisit.css') }}" />
  <link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
  crossorigin="anonymous"
/>

</head>
<body>

<!-- ================= NAVBAR ================= -->
<header class="navbar">
  <div class="logo">
    <i class="fa-solid fa-industry"></i>
    <div>
      <strong>IndusTech</strong><br>
      <small>Industrial Ecosystem</small>
    </div>
  </div>

  <nav class="nav-links">
    <a href="{{ url_for('home') }}" > <i class="fa-solid fa-house"></i> Home</a>
    <a href="{{url_for('industrymap') }}">  <i class="fa-solid fa-location-dot"></i> Industrial Map</a>
    <a href="{{url_for('jobportal') }}" class="active"> <i class="fa-solid fa-briefcase"></i> Job Portal</a>
    <a href="{{ url_for('trade')}}"> <i class="fa-solid fa-box"></i> B2B Trade</a>
  </nav>

  <div class="auth">
    {% if session.get('user_type') == 'worker' %}
      <a href="{{ url_for('workerprofile') }}" class="profile"> <i class='fa-solid fa-user'></i> My profile</a>
    <a href="{{ url_for('logout') }}" class="signup">Logout</a>
    {% elif session.get('user_type') == 'company' %}
    <a href="{{ url_for('companyprofile') }}" class="profile"> <i class='fa-solid fa-user'></i> My profile</a>
    <a href="{{ url_for('logout') }}" class="signup">Logout</a>
    {% else %}
    <a href="{{ url_for('login') }}" class="signup">Login</a>
    {% endif %}
  </div>
</header>

<!-- ===== MAIN CONTENT ===== -->
<main class="container">

    <a href="{{ url_for('jobportal')}}" class="back-to-jobs">
        <i class="fa-solid fa-arrow-left"></i>
        Back to Jobs
      </a>
      

  <div class="content-grid">

    <!-- ===== LEFT CARD ===== -->
    <div class="left-column">

    <section class="card job-card">

        <div class="job-header-row">

            <div class="job-header-left">
              <div class="job-icon">üè≠</div>
              <div>
                <h1>{{ job.job_title }}</h1>
                <a href="{{ url_for('companyprofile_public', company_id=job.company.id) }}" class="company-name">
                  {{ job.company.company_name }}
                </a>
              </div>
            </div>
          
            <div class="job-header-actions">
              <button class="icon-btn" title="Save Job">
                <i class="fa-regular fa-heart"></i>
              </button>
          
              <button class="icon-btn" id="shareJobBtn"  title="Share Job">
                <i class="fa-solid fa-share-nodes"></i>
              </button>
            </div>
          
          </div>
          

      <div class="salary-box">‚Çπ {{ job.salary }}</div>

      <div class="job-meta">
        <div class="meta-item">üìç {{ job.city | title }}</div>
        <div class="meta-item">‚è∞ {{ job.job_start_time.strftime("%I:%M %p") }}
          ‚Äì
          {{ job.job_end_time.strftime("%I:%M %p") }}</div>
        <div class="meta-item">üë• {{ job.job_opening_no }} Openings</div>
        <div class="meta-item">üí∞ {{ job.shift }}</div>
      </div>

      <h3>Job Description</h3>
      <p>
        {{ job.description }}.
      </p>

      <!-- <h3>Requirements</h3>
      <ul class="requirements">
        <li>
          <i class="fa-solid fa-circle-check"></i>
          Age 18‚Äì45
        </li>
        <li>
          <i class="fa-solid fa-circle-check"></i>
          Ability to stand for long hours
        </li>
        <li>
          <i class="fa-solid fa-circle-check"></i>
          Basic literacy
        </li>
      </ul>       -->
    </section>
    <!-- ===== COMPANY INFO ===== -->
  <section class="card company-card">
    <h3>About the Company</h3>
  
    <a href="{{ url_for('companyprofile_public', company_id=job.company.id) }}" class="company-link"> 
        <div class="company-box">
          <div class="company-icon">
            <i class="fa-solid fa-industry"></i>
          </div>
      
          <div class="company-details">
            <h4 class="company-name-title">{{ job.company.company_name }}</h4>
            <p class="company-type">{{ job.company.company_category or "Industry" }}</p>
      
            <div class="company-meta">
              <span>{{ job.company.company_city | title }}</span>
              <span>{{ job.company.company_size or "" }}</span>
            </div>
          </div>
        </div>
      </a>      
  </section>
    </div>

    <!-- ===== RIGHT CARD ===== -->
    <div class="apply-card">

      <!-- ================= SUMMARY VIEW ================= -->
      <div id="applySummary">
    
        <h3>Ready to Apply?</h3>
    
        <div class="apply-info">
          <div class="info-row">
            <i class="fa-solid fa-location-dot"></i>
            <span>{{ job.city | title }}</span>
          </div>
    
          <div class="info-row">
            <i class="fa-regular fa-clock"></i>
            <span>
              {{ job.job_start_time.strftime("%I:%M %p") }} ‚Äì
              {{ job.job_end_time.strftime("%I:%M %p") }}
            </span>
          </div>
        </div>
    
        <button class="apply-btn" onclick="showApplyForm()">
          <i class="fa-regular fa-circle-check"></i> Apply Now
        </button>
    
        <a href="tel:{{ job.job_contact }}" class="contact-btn">
          <i class="fa-solid fa-phone"></i> Contact Company
        </a>
    
        <p class="posted-date">
          Posted on {{ job.created_at.strftime("%d %b %Y") }}
        </p>
    
      </div>
    
      <!-- ================= APPLY FORM VIEW ================= -->
      <div id="applyFormContainer" style="display:none;">
    
        <h3>Apply for this Job</h3>
    
        <form method="POST" action="{{ url_for('applyjob') }}">
    
          <input type="hidden" name="job_id" value="{{ job.job_id }}">
    
          <div class="form-group">
            <label>Full Name</label>
            <input type="text" name="applicant_name"
                   value="{{ worker.name if worker else '' }}" required>
          </div>
    
          <div class="form-group">
            <label>Email</label>
            <input type="email" name="applicant_email"
                   value="{{ worker.email if worker else '' }}">
          </div>
    
          <div class="form-group">
            <label>Phone</label>
            <input type="tel" name="applicant_phone"
                   value="{{ worker.phone_no if worker else '' }}" required>
          </div>
    
          <div class="form-group">
            <label>Age</label>
            <input type="number" name="applicant_age" value="{{ worker_age or ''}}">
          </div>
    
          <div class="form-group">
            <label>Gender</label>
            <select name="applicant_gender" required>
              <option value="">Select</option>
              <option value="Male" {{ 'selected' if worker and worker.gender == 'Male' else '' }}>Male</option>
              <option value="Female" {{ 'selected' if worker and worker.gender == 'Female' else '' }}>Female</option>
              <option value="Other" {{ 'selected' if worker and worker.gender == 'Other' else '' }}>Other</option>
            </select>
          </div>
    
          <div class="form-group">
            <label>Skill</label>
            <input type="text" name="applicant_skill"
                   placeholder="e.g. Machine Operator" required>
          </div>
    
          <div class="form-group">
            <label>Current Location</label>
            <input type="text" name="applicant_location"
                   value="{{ worker.address if worker else '' }}" required>
          </div>
    
          <button type="submit" class="apply-btn full">
            Submit Application
          </button>
    
          <button type="button" class="contact-btn outline"
                  onclick="cancelApplyForm()">
            Cancel
          </button>
    
        </form>
      </div>
    
    </div>
    

  
  

</main>

<!-- ===== FOOTER ===== -->
<footer>
  <div class="footer-content">
      <div class="footer-section">
          <h4>IndusTech</h4>
          <p>Connecting India's industrial workforce with opportunities.</p>
      </div>
      <div class="footer-section">
          <h4>Quick Links</h4>
          <a href="home.html">Home</a>
          <a href="job-portal.html">Find Jobs</a>
          <a href="industry-map.html">Industry Map</a>
          <a href="b2btrade.html">B2B Trade</a>
      </div>
      <div class="footer-section">
          <h4>Support</h4>
          <a href="#">Help Center</a>
          <a href="#">Contact Us</a>
          <a href="#">Privacy Policy</a>
          <a href="#">Terms of Service</a>
      </div>
  </div>
</footer>

<script>
  function showApplyForm() {
    document.getElementById("applySummary").style.display = "none";
    document.getElementById("applyFormContainer").style.display = "block";
  }
  
  function cancelApplyForm() {
    document.getElementById("applyFormContainer").style.display = "none";
    document.getElementById("applySummary").style.display = "block";
  }
  </script>
  
  
<script>
    document.getElementById("shareJobBtn").addEventListener("click", async () => {
      const shareData = {
        title: "Production Helper - IndusTech",
        text: "Check out this job opening at ABC Manufacturing Pvt Ltd",
        url: window.location.href
      };
  
      // ‚úÖ Modern mobile & supported browsers
      if (navigator.share) {
        try {
          await navigator.share(shareData);
        } catch (err) {
          console.log("Share cancelled");
        }
      } 
      // üß† Desktop fallback
      else {
        navigator.clipboard.writeText(shareData.url);
        alert("Job link copied to clipboard!");
      }
    });
  </script>
  
</body>
</html>
